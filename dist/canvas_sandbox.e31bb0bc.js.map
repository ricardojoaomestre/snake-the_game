{"version":3,"sources":["src/Position.js","src/Direction.js","src/Snake.js","src/World.js","index.js"],"names":["Position","x","y","Direction","h","v","Snake","p","d","c","position","direction","body","size","snakeSquare","context","fillRect","hit","i","length","tail","unshift","isAHit","paused","console","log","pop","clearRect","draw","World","height","width","fruits","maxFruits","fruitSize","push","generateFruit","Math","random","save","fillStyle","beginPath","closePath","restore","window","innerWidth","innerHeight","fps","PIXEL_RATIO","ctx","document","getElementById","getContext","dpr","devicePixelRatio","bsr","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","createHiDPICanvas","w","ratio","can","style","setTransform","canvas","snake","world","animate","setTimeout","requestAnimationFrame","update","addEventListener","evt","keyCode","canGoUp","goUp","canGoDown","goDown","canGoLeft","goLeft","canGoRight","goRight"],"mappings":"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","file":"canvas_sandbox.e31bb0bc.js","sourceRoot":"..","sourcesContent":["export default class Position {\n  /**\n   * Position: represents a position on the screen.\n   * @param {int} x the X coordinate\n   * @param {*} y the Y coordinate\n   */\n  constructor(x, y) {\n    this.x = x;\n    this.y = y;\n  }\n}\n","export default class Direction {\n  /**\n   *\n   * Direction: represents a direction by horizontal e vertical properties.\n   * @param {int} h horizontal direction (-1: left; 0: neutral; 1: right)\n   * @param {int} v vertical direction (-1: up; 0: neutral; 1: down)\n   */\n  constructor(h, v) {\n    this.h = h;\n    this.v = v;\n  }\n\n  /**\n   * returns true if it's possible to turn left\n   */\n  canGoLeft() {\n    return this.h === 0;\n  }\n\n  /**\n   * changes horizontal direction to -1 (left)\n   */\n  goLeft() {\n    this.v = 0;\n    this.h = -1;\n  }\n\n  /**\n   * returns true if it's possible to turn right\n   */\n  canGoRight() {\n    return this.h === 0;\n  }\n\n  /**\n   * changes horizontal direction to 1 (right)\n   */\n  goRight() {\n    this.v = 0;\n    this.h = 1;\n  }\n\n  /**\n   * returns true if it's possible to turn up\n   */\n  canGoUp() {\n    return this.v === 0;\n  }\n\n  /**\n   * changes vertical direction to -1 (up)\n   */\n  goUp() {\n    this.v = -1;\n    this.h = 0;\n  }\n\n  /**\n   * returns true if it's possible to turn down\n   */\n  canGoDown() {\n    return this.v === 0;\n  }\n\n  /**\n   * changes vertical direction to 1 (down)\n   */\n  goDown() {\n    this.v = 1;\n    this.h = 0;\n  }\n}\n","import Position from \"./Position\";\n\nexport default class Snake {\n  /**\n   * Snake: Represents the game actor: the snake.\n   * @param {Position} p the position of the head of the snake\n   * @param {Direction} d the direction of the snake\n   * @param {Object} c the canvas context\n   */\n  constructor(p, d, c) {\n    this.position = p;\n    this.direction = d;\n    this.body = [p];\n    this.size = 20;\n    this.snakeSquare = 15;\n    this.context = c;\n  }\n\n  /**\n   * draws the snake body\n   */\n  draw() {\n    this.context.fillRect(\n      this.position.x * this.snakeSquare + this.snakeSquare / 2,\n      this.position.y * this.snakeSquare + this.snakeSquare / 2,\n      this.snakeSquare,\n      this.snakeSquare\n    );\n  }\n\n  /**\n   * Returns true if the head of the snake hits its own body\n   */\n  isAHit() {\n    var hit = false;\n    for (var i = 1; i < this.body.length && !hit; i++) {\n      hit =\n        this.body[i].x === this.position.x &&\n        this.body[i].y === this.position.y;\n    }\n    return hit;\n  }\n\n  /**\n   * Updates the position of the snake based on its direction and evaluates if there's a hit.\n   */\n  update() {\n    var tail;\n    // adds head's new position\n    this.body.unshift(\n      new Position(\n        this.position.x + this.direction.h,\n        this.position.y + this.direction.v\n      )\n    );\n\n    // updates head's position\n    this.position = this.body[0];\n\n    if (this.isAHit()) {\n      paused = true;\n      console.log(\"lost!\");\n    } else {\n      // if body has grown enough, remove the tail at the end\n      if (this.body.length === this.size) {\n        tail = this.body.pop();\n        this.context.clearRect(\n          tail.x * this.snakeSquare + this.snakeSquare / 2,\n          tail.y * this.snakeSquare + this.snakeSquare / 2,\n          this.snakeSquare,\n          this.snakeSquare\n        );\n      }\n\n      // the game pauses and prints 'lost', else draw the snake\n      this.draw();\n    }\n  }\n}\n","import Position from \"./Position\";\n\nexport default class World {\n  constructor(height, width, context) {\n    this.fruits = [];\n    this.width = width;\n    this.height = height;\n    this.context = context;\n    this.maxFruits = 5;\n    this.fruitSize = 15;\n    for (var i = 0; i < this.maxFruits; i++) {\n      this.fruits.push(this.generateFruit());\n    }\n  }\n\n  generateFruit() {\n    return new Position(\n      Math.random() * this.width,\n      Math.random() * this.height\n    );\n  }\n\n  draw() {\n    this.context.save();\n    this.context.fillStyle = \"rgb(255,0,0)\";\n    for (var i = 0; i < this.fruits.length; i++) {\n      this.context.beginPath();\n      this.context.fillRect(\n        this.fruits[i].x,\n        this.fruits[i].y,\n        this.fruitSize,\n        this.fruitSize\n      );\n      this.context.closePath();\n    }\n    this.context.restore();\n  }\n}\n","import Position from \"./src/Position\";\nimport Direction from \"./src/Direction\";\nimport Snake from \"./src/Snake\";\nimport World from \"./src/World\";\n\nconst width = window.innerWidth;\nconst height = window.innerHeight;\nconst fps = 8; // game speed\nvar paused = false; // game pause trigger\n/**\n * Calculates the pixel ratio of the screen\n */\nvar PIXEL_RATIO = (function() {\n  var ctx = document.getElementById(\"canvas\").getContext(\"2d\"),\n    dpr = window.devicePixelRatio || 1,\n    bsr =\n      ctx.webkitBackingStorePixelRatio ||\n      ctx.mozBackingStorePixelRatio ||\n      ctx.msBackingStorePixelRatio ||\n      ctx.oBackingStorePixelRatio ||\n      ctx.backingStorePixelRatio ||\n      1;\n\n  return dpr / bsr;\n})();\n\n/**\n * Returns the context and canvas configured to support the aspect ratio of the browser\n * @param {int} w window width\n * @param {int} h window height\n * @param {int} ratio device aspect ratio\n */\nconst createHiDPICanvas = function(w, h, ratio) {\n  if (!ratio) {\n    ratio = PIXEL_RATIO;\n  }\n  var can = document.getElementById(\"canvas\");\n  can.width = w * ratio;\n  can.height = h * ratio;\n  can.style.width = w + \"px\";\n  can.style.height = h + \"px\";\n  var ctx = can.getContext(\"2d\");\n  ctx.setTransform(ratio, 0, 0, ratio, 0, 0);\n  return { canvas: can, context: ctx };\n};\n\nvar { canvas, context } = createHiDPICanvas(width, height);\nconst snake = new Snake(new Position(0, 0), new Direction(1, 0), context);\nconst world = new World(width, height, context);\n\n/**\n * Animation loop function\n */\nfunction animate() {\n  if (paused) return;\n\n  setTimeout(function() {\n    requestAnimationFrame(animate);\n    snake.update();\n  }, 1000 / fps);\n}\n\n/**\n * Key events to move the snake\n */\nwindow.addEventListener(\"keydown\", evt => {\n  switch (evt.keyCode) {\n    case 38:\n      snake.direction.canGoUp() && snake.direction.goUp();\n      break;\n    case 40:\n      snake.direction.canGoDown() && snake.direction.goDown();\n      break;\n    case 37:\n      snake.direction.canGoLeft() && snake.direction.goLeft();\n\n      break;\n    case 39:\n      snake.direction.canGoRight() && snake.direction.goRight();\n      break;\n    case 32:\n      paused = !paused;\n      if (!paused) animate();\n      break;\n  }\n});\n\nworld.draw();\nanimate();\n"]}